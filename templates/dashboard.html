{% extends "base.html" %}

{% block content %}
<h2 class="mb-4">Dashboard</h2>
{% for course in courses %}
  <div class="card mb-4">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <span>{{ course.name }} (Section: {{ course.section }})</span>
      <div>
        <a href="{{ url_for('add_assignment', course_id=course.id) }}" class="btn btn-sm btn-light">
          <i class="bi bi-plus-circle"></i> Add Task
        </a>
        <a href="{{ url_for('delete_course', course_id=course.id) }}" class="btn btn-sm btn-danger"
           onclick="return confirm('Are you sure you want to delete this course and all its tasks?');">
          <i class="bi bi-trash"></i> Delete Course
        </a>
      </div>
    </div>
    <div class="card-body">
      {% if course.assignments %}
        <table class="table table-hover table-bordered align-middle">
          <thead class="table-secondary">
            <tr>
              <th>Title</th>
              <th>Type</th>
              <th>Due Date</th>
              <th>Max Grade</th>
              <th>Your Grade</th>
              <th>Completed</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for task in course.assignments %}
              <tr>
                <td>{{ task.title }}</td>
                <td>{{ task.type }}</td>
                <td>{{ task.due_date }}</td>
                <td>{{ task.max_grade }}</td>
                <td>{{ task.grade if task.grade is not none else '-' }}</td>
                <td>
                  <input type="checkbox" {% if task.completed %}checked{% endif %} disabled>
                </td>
                <td>
                  <a href="{{ url_for('edit_grade', assignment_id=task.id) }}" class="btn btn-sm btn-success mb-1">
                    <i class="bi bi-pencil-square"></i> Add/Edit Grade
                  </a>
                  <a href="{{ url_for('delete_assignment', assignment_id=task.id) }}" class="btn btn-sm btn-danger mb-1"
                     onclick="return confirm('Are you sure you want to delete this task?');">
                    <i class="bi bi-trash"></i> Delete
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="text-muted">No Tasks added yet.</p>
      {% endif %}
    </div>
  </div>
{% endfor %}
{% endblock %}
